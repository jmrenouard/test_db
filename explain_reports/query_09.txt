QUERY:
SELECT de.dept_no, s.emp_no, s.salary, RANK() OVER (PARTITION BY de.dept_no ORDER BY s.salary DESC) as dept_rank FROM salaries s JOIN dept_emp de ON s.emp_no = de.emp_no WHERE s.to_date = '9999-01-01' AND de.to_date = '9999-01-01'

EXPLAIN PLAN:
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	de	ALL	PRIMARY	NULL	NULL	NULL	331143	Using where; Using temporary
1	SIMPLE	s	ref	PRIMARY	PRIMARY	4	employees.de.emp_no	1	Using where

ANALYSIS ISSUES:
- Temporary table used.
- Full Table Scan (ALL) detected.
